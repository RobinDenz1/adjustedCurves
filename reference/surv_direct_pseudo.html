<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Direct Adjusted Survival Curves using Pseudo-Values — surv_direct_pseudo • adjustedCurves</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Direct Adjusted Survival Curves using Pseudo-Values — surv_direct_pseudo"><meta name="description" content='

This page explains the details of estimating direct adjusted survival curves using pseudo-values for single event time-to-event data (method="direct_pseudo" in the adjustedsurv function). All regular arguments of the adjustedsurv function can be used. Additionally, the outcome_vars argument has to be specified in the adjustedsurv call. Further arguments specific to this method are listed below.'><meta property="og:description" content='

This page explains the details of estimating direct adjusted survival curves using pseudo-values for single event time-to-event data (method="direct_pseudo" in the adjustedsurv function). All regular arguments of the adjustedsurv function can be used. Additionally, the outcome_vars argument has to be specified in the adjustedsurv call. Further arguments specific to this method are listed below.'><meta property="og:image" content="https://robindenz1.github.io/adjustedCurves/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">adjustedCurves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/adjustedCurves.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/method_overview.html">Overview of methods in adjustedCurves</a></li>
    <li><a class="dropdown-item" href="../articles/plot_customization.html">Customizing Adjusted Survival Curve Plots</a></li>
    <li><a class="dropdown-item" href="../articles/comparing_groups.html">Comparing Adjusted Survival Curves or Cumulative Incidence Curves</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions about the adjustedCurves Package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinDenz1/adjustedCurves/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Direct Adjusted Survival Curves using Pseudo-Values</h1>

      <div class="d-none name"><code>surv_direct_pseudo.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>This page explains the details of estimating direct adjusted survival curves using pseudo-values for single event time-to-event data (<code>method="direct_pseudo"</code> in the <code><a href="adjustedsurv.html">adjustedsurv</a></code> function). All regular arguments of the <code>adjustedsurv</code> function can be used. Additionally, the <code>outcome_vars</code> argument has to be specified in the <code>adjustedsurv</code> call. Further arguments specific to this method are listed below.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-outcome-vars">outcome_vars<a class="anchor" aria-label="anchor" href="#arg-outcome-vars"></a></dt>
<dd><p>[<strong>required</strong>] A character vector of column names specifying variables to be used when modeling the outcome mechanism. See details and examples.</p></dd>

  <dt id="arg-type-time">type_time<a class="anchor" aria-label="anchor" href="#arg-type-time"></a></dt>
<dd><p>A character string specifying how the time should be modeled. Possible values are <code>"factor"</code> (modeling each point in time as a separate variable, the default), <code>"bs"</code> (modeling time using B-Splines) or <code>"ns"</code> (modeling time using natural splines).</p></dd>

  <dt id="arg-spline-df">spline_df<a class="anchor" aria-label="anchor" href="#arg-spline-df"></a></dt>
<dd><p>The number of degrees of freedom used for the natural-spline or B-spline function. Ignored if <code>type_time="factor"</code>. Defaults to 5.</p></dd>

  <dt id="arg-censoring-vars">censoring_vars<a class="anchor" aria-label="anchor" href="#arg-censoring-vars"></a></dt>
<dd><p>An optional character vector specifying variables in <code>data</code>. Those are used in the calculation of inverse probability of censoring weighted pseudo observations. See <code>?pseudo_aareg</code> for more information. Set to <code>NULL</code> (default) to use standard pseudo-values without corrections for dependent censoring instead.</p></dd>

  <dt id="arg-ipcw-method">ipcw_method<a class="anchor" aria-label="anchor" href="#arg-ipcw-method"></a></dt>
<dd><p>The specific method used in the calculation of inverse probability of censoring weighted pseudo observations. Can be either <code>"binder"</code> (default) or <code>"hajek"</code>. See <code>?pseudo_aareg</code> for more information. Ignored if <code>censoring_vars=NULL</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<ul><li><p><strong>Type of Adjustment:</strong> Requires a character vector of variable names used to model the outcome mechanism (internally uses <code><a href="https://rdrr.io/pkg/geepack/man/geese.html" class="external-link">geese</a></code>).</p></li>
<li><p><strong>Doubly-Robust:</strong> Estimates are not Doubly-Robust.</p></li>
<li><p><strong>Categorical groups:</strong> Any number of levels in <code>variable</code> are allowed. Must be a factor variable.</p></li>
<li><p><strong>Approximate Variance:</strong> Calculations to approximate the variance and confidence intervals are not available. Bootstrapping can still be used to estimate the confidence intervals (see <code><a href="adjustedsurv.html">?adjustedsurv</a></code>).</p></li>
<li><p><strong>Allowed Time Values:</strong> Allows both continuous and integer time.</p></li>
<li><p><strong>Bounded Estimates:</strong> Estimates are not guaranteed to be bounded in the 0 to 1 probability range.</p></li>
<li><p><strong>Monotone Function:</strong> Estimates are not guaranteed to be monotone.</p></li>
<li><p><strong>Dependencies:</strong> This method relies on the <span class="pkg">geepack</span> and <span class="pkg">prodlim</span> packages. Additionally requires the <span class="pkg">eventglm</span> package if <code>censoring_vars</code> is specified.</p></li>
</ul><p>This method works by executing the following steps: (1) First Pseudo-Values for the survival probabilities are estimated for each observation in the dataset and some points in time T. Afterwards (2) a new dataset is created in which every individual observation has multiple rows, one for each point in time of interest. (3) This dataset is used to fit a generalized estimating equations (geese) model, using the Pseudo-Values as independent variable. Next (4) multiple copies of the new dataset are created, one for each possible level of the <code>variable</code> of interest. (5) The <code>variable</code> is then set to one level for all observations in each dataset. (5) The <code>geese</code> model is used to predict the survival probabilities at some points in time T for each observation in all dataset copies. (6) Those estimated probabilities are averaged for each dataset at each point in time, resulting in adjusted survival probabilities for all levels of the group variable at the specified points in time.</p>
<p>It is essentially the same procedure as described in <code><a href="surv_direct.html">"direct"</a></code>. The only difference is that instead of relying on a <code>coxph</code> model, this method uses Pseudo-Values and a geese model. This can be useful if the data does not conform to some assumptions needed to use the Cox-Regression model (for example the proportional hazards assumption).</p>
<p>When estimating the <code>geese</code> model the <code>ev_time</code> variable is used as a factor by default. This results in one coefficient being estimated for each unique point in time, which can be very slow computationally if there are a lot of unique points in time and/or the dataset has many rows. In these cases it is recommended to use <code>type_time="bs"</code> or <code>type_time="ns"</code>, which results in the <code>ev_time</code> being modeled using B-Splines or Natural Splines. Simulation studies indicate that there is little difference in the estimates when an appropriately large number of <code>spline_df</code> is used.</p>
<p>Additionally, covariate-dependent censoring can be accounted for by using inverse probability of censoring weighted pseudo-values (Binder et al. 2014) instead of regular pseudo-values (specified using the <code>censoring_vars</code> and <code>ipcw_method</code> arguments).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Adds the following additional objects to the output of the <code>adjustedsurv</code> function:</p>
<ul><li><p><code>pseudo_values</code>: The matrix of estimated pseudo-values.</p></li>
<li><p><code>geese_model</code>: The geese model used to make the predictions.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Per Kragh Andersen, Elisavet Syriopoulou, and Erik T. Parner (2017). "Causal Inference in Survival Analysis using Pseudo-Observations". In: Statistics in Medicine 36, pp. 2669-2681</p>
<p>Per Kragh Andersen and Maja Pohar Perme (2010). "Pseudo-Observations in Survival Analysis". In: Statistical Methods in Medical Research 19, pp. 71-99</p>
<p>Aris Perperoglou, Willi Sauerbrei, Michal Abrahamowicz, and Matthias Schmid (2019). "A Review of Spline Function Procedures in R". in: BMC Medical Research Methodology 19.46, pp. 1-16</p>
<p>Nadine Binder, Thomas A. Gerds, and Per Kragh Andersen (2014). "Pseudo-Observations for Competing Risks with Covariate Dependent Censoring". In: Lifetime Data Analysis 20, pp. 303-315</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Robin Denz</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/geepack/man/geese.html" class="external-link">geese</a></code>, <code><a href="https://rdrr.io/pkg/prodlim/man/jackknife.html" class="external-link">jackknife</a></code>, <code><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></code>, <code><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobinDenz1/adjustedCurves" class="external-link">adjustedCurves</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"geepack"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"prodlim"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">prodlim</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate some data as example</span></span></span>
<span class="r-in"><span><span class="va">sim_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_confounded_surv.html">sim_confounded_surv</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, max_t<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_dat</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">sim_dat</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate adjusted survival curves, with time as factor</span></span></span>
<span class="r-in"><span><span class="va">adjsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="adjustedsurv.html">adjustedsurv</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sim_dat</span>,</span></span>
<span class="r-in"><span>                        variable<span class="op">=</span><span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                        ev_time<span class="op">=</span><span class="st">"time"</span>,</span></span>
<span class="r-in"><span>                        event<span class="op">=</span><span class="st">"event"</span>,</span></span>
<span class="r-in"><span>                        method<span class="op">=</span><span class="st">"direct_pseudo"</span>,</span></span>
<span class="r-in"><span>                        outcome_vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>, <span class="st">"x6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        type_time<span class="op">=</span><span class="st">"factor"</span>,</span></span>
<span class="r-in"><span>                        force_bounds<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        iso_reg<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># with time modelled as B-Spline using 5 degrees of freedom</span></span></span>
<span class="r-in"><span><span class="va">adjsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="adjustedsurv.html">adjustedsurv</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sim_dat</span>,</span></span>
<span class="r-in"><span>                        variable<span class="op">=</span><span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                        ev_time<span class="op">=</span><span class="st">"time"</span>,</span></span>
<span class="r-in"><span>                        event<span class="op">=</span><span class="st">"event"</span>,</span></span>
<span class="r-in"><span>                        method<span class="op">=</span><span class="st">"direct_pseudo"</span>,</span></span>
<span class="r-in"><span>                        outcome_vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>, <span class="st">"x6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        type_time<span class="op">=</span><span class="st">"bs"</span>,</span></span>
<span class="r-in"><span>                        spline_df<span class="op">=</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>                        force_bounds<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        iso_reg<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the curves</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adjsurv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="surv_direct_pseudo-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin Denz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

