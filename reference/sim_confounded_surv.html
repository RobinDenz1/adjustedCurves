<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate Survival Data with Confounders — sim_confounded_surv • adjustedCurves</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate Survival Data with Confounders — sim_confounded_surv"><meta name="description" content="A function to simulate time-to-event data with one or multiple confounders. The user can specify both the relationship between the covariates and the survival time and the relationship between the covariates and the treatment assignment probability. Random censoring based on a custom function may also be introduced. Can be used for simulation studies or to showcase the usage of the adjusted survival curve methodology presented in this package."><meta property="og:description" content="A function to simulate time-to-event data with one or multiple confounders. The user can specify both the relationship between the covariates and the survival time and the relationship between the covariates and the treatment assignment probability. Random censoring based on a custom function may also be introduced. Can be used for simulation studies or to showcase the usage of the adjusted survival curve methodology presented in this package."><meta property="og:image" content="https://robindenz1.github.io/adjustedCurves/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">adjustedCurves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/comparing_groups.html">Comparing Adjusted Survival Curves or Cumulative Incidence Curves</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions about the adjustedCurves Package</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">An Introduction to the 'adjustedCurves' Package</a></li>
    <li><a class="dropdown-item" href="../articles/method_overview.html">Overview of methods in adjustedCurves</a></li>
    <li><a class="dropdown-item" href="../articles/plot_customization.html">Customizing Adjusted Survival Curve Plots</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinDenz1/adjustedCurves/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate Survival Data with Confounders</h1>

      <div class="d-none name"><code>sim_confounded_surv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to simulate time-to-event data with one or multiple confounders. The user can specify both the relationship between the covariates and the survival time and the relationship between the covariates and the treatment assignment probability. Random censoring based on a custom function may also be introduced. Can be used for simulation studies or to showcase the usage of the adjusted survival curve methodology presented in this package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim_confounded_surv</span><span class="op">(</span>n<span class="op">=</span><span class="fl">500</span>, lcovars<span class="op">=</span><span class="cn">NULL</span>, outcome_betas<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                    group_beta<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, surv_dist<span class="op">=</span><span class="st">"weibull"</span>,</span>
<span>                    gamma<span class="op">=</span><span class="fl">1.8</span>, lambda<span class="op">=</span><span class="fl">2</span>, treatment_betas<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                    intercept<span class="op">=</span><span class="op">-</span><span class="fl">0.5</span>, gtol<span class="op">=</span><span class="fl">0.001</span>,</span>
<span>                    cens_fun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">}</span>,</span>
<span>                    cens_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, max_t<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>An integer specifying the sample size of the simulated data set.</p></dd>

  <dt id="arg-lcovars">lcovars<a class="anchor" aria-label="anchor" href="#arg-lcovars"></a></dt>
<dd><p>A named list to specify covariates. Each list element should be a vector containing information on the desired covariate distribution. See details.</p></dd>

  <dt id="arg-outcome-betas">outcome_betas<a class="anchor" aria-label="anchor" href="#arg-outcome-betas"></a></dt>
<dd><p>A named numeric vector of beta coefficients for the time-to-event outcome.</p></dd>

  <dt id="arg-group-beta">group_beta<a class="anchor" aria-label="anchor" href="#arg-group-beta"></a></dt>
<dd><p>A number specifying the beta coefficient of the grouping variable on the survival time.</p></dd>

  <dt id="arg-surv-dist">surv_dist<a class="anchor" aria-label="anchor" href="#arg-surv-dist"></a></dt>
<dd><p>A character string denoting the distribution used in the simulation of the survival time. See details.</p></dd>

  <dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>A numeric parameter for the simulation of the survival time. See details.</p></dd>

  <dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A numeric parameter for the simulation of the survival time. See details.</p></dd>

  <dt id="arg-treatment-betas">treatment_betas<a class="anchor" aria-label="anchor" href="#arg-treatment-betas"></a></dt>
<dd><p>A named numeric vector of beta coefficients for the treatment assignment model.</p></dd>

  <dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>The intercept of the treatment assignment model.</p></dd>

  <dt id="arg-gtol">gtol<a class="anchor" aria-label="anchor" href="#arg-gtol"></a></dt>
<dd><p>Tolerance at which estimated treatment assignment probabilities are truncated.</p></dd>

  <dt id="arg-cens-fun">cens_fun<a class="anchor" aria-label="anchor" href="#arg-cens-fun"></a></dt>
<dd><p>A function to generate censoring times or <code>NULL</code>. If <code>NULL</code>, no censoring is introduced.</p></dd>

  <dt id="arg-cens-args">cens_args<a class="anchor" aria-label="anchor" href="#arg-cens-args"></a></dt>
<dd><p>Arguments passed to <code>cens_fun</code>. Ignored if <code>cens_fun=NULL</code>.</p></dd>

  <dt id="arg-max-t">max_t<a class="anchor" aria-label="anchor" href="#arg-max-t"></a></dt>
<dd><p>A number denoting the maximum follow-up time. Every event time bigger than this threshold are censored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>The simulation of the confounded survival data has four main steps: (1) Generation of covariates, (2) Assigning the treatment variable, (3) Generating survival times and (4) introducing censoring.</p>
<p>First, covariates are generated by taking independent <code>n</code> random samples from the distributions defined in <code>lcovars</code>.</p>
<p>In the second step the generated covariates are used to estimate the probability of receiving treatment (the propensity score) for each simulated person in the dataset. This is done using a logistic regression model, using the values in <code>treatment_betas</code> as coefficients and <code>interecept</code> as the intercept. By changing the intercept, the user can vary the proportion of cases that end up in each treatment group on average. The estimated probabilities are then used to generate the treatment variable ("group"), making the treatment assignment dependent on the covariates.</p>
<p>Next, survival times are generated based on the method described in Bender et al. (2005) using the causal coefficients defined in <code>outcome_betas</code> and <code>group_beta</code>. Both the independently generated covariates and the covariate-dependent treatment variable are used in this step. This introduces confounding.</p>
<p>Independent right-censoring is introduced by taking <code>n</code> independent random draws from some distribution defined by <code>cens_fun</code> and censoring every individual whose censoring time is smaller than its simulated survival time. The whole process is based on work from Chatton et al. (2020).</p>
<p>Currently only supports binary treatments and does not allow dependent censoring.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code>data.frame</code> object containing the simulated covariates, the event indicator ("event"), the survival/censoring time ("time") and the group variable ("group").</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ralf Bender, Thomas Augustin, and Maria Blettner (2005). "Generating Survival Times to Simulate Cox Proportional Hazards Models". In: Statistics in Medicine 24.11, pp. 1713-1723</p>
<p>Arthur Chatton, Florent Le Borgne, Clémence Leyrat, and Yohann Foucher (2020). G-Computation and Inverse Probability Weighting for Time-To-Event Outcomes: A Comparative Study. arXiv:2006.16859v1</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Robin Denz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobinDenz1/adjustedCurves" class="external-link">adjustedCurves</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate data with default values</span></span></span>
<span class="r-in"><span><span class="va">sim_dat</span> <span class="op">&lt;-</span> <span class="fu">sim_confounded_surv</span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate data with some new values</span></span></span>
<span class="r-in"><span><span class="va">lcovars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rnorm"</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rnorm"</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                x3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"runif"</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treatment_betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fl">0.2</span>, x2<span class="op">=</span><span class="fl">0.6</span>, x3<span class="op">=</span><span class="op">-</span><span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome_betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fl">1.1</span>, x2<span class="op">=</span><span class="fl">0</span>, x3<span class="op">=</span><span class="op">-</span><span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim_dat</span> <span class="op">&lt;-</span> <span class="fu">sim_confounded_surv</span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, lcovars<span class="op">=</span><span class="va">lcovars</span>,</span></span>
<span class="r-in"><span>                               treatment_betas<span class="op">=</span><span class="va">treatment_betas</span>,</span></span>
<span class="r-in"><span>                               outcome_betas<span class="op">=</span><span class="va">outcome_betas</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin Denz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

