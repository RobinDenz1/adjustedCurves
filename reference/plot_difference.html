<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A function to graphically display the difference between two confounder-adjusted survival curves which where previously estimated using the adjustedsurv function or between two confounder-adjusted CIFs which where previously estimated using the adjustedcif function. The user can customize the plot using a variety of options. Internally it uses the ggplot2 package, so additional not implemented features can be added using the standard ggplot2 syntax."><title>Plot the Difference of Two Adjusted Survival Curves or CIFs — plot_difference • adjustedCurves</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot the Difference of Two Adjusted Survival Curves or CIFs — plot_difference"><meta property="og:description" content="A function to graphically display the difference between two confounder-adjusted survival curves which where previously estimated using the adjustedsurv function or between two confounder-adjusted CIFs which where previously estimated using the adjustedcif function. The user can customize the plot using a variety of options. Internally it uses the ggplot2 package, so additional not implemented features can be added using the standard ggplot2 syntax."><meta property="og:image" content="https://robindenz1.github.io/adjustedCurves/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">adjustedCurves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">An Introduction to the 'adjustedCurves' Package</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RobinDenz1/adjustedCurves/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot the Difference of Two Adjusted Survival Curves or CIFs</h1>
      
      <div class="d-none name"><code>plot_difference.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to graphically display the difference between two confounder-adjusted survival curves which where previously estimated using the <code><a href="adjustedsurv.html">adjustedsurv</a></code> function or between two confounder-adjusted CIFs which where previously estimated using the <code><a href="adjustedcif.html">adjustedcif</a></code> function. The user can customize the plot using a variety of options. Internally it uses the <span class="pkg">ggplot2</span> package, so additional not implemented features can be added using the standard <code>ggplot2</code> syntax.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_difference</span><span class="op">(</span><span class="va">x</span>, group_1<span class="op">=</span><span class="cn">NULL</span>, group_2<span class="op">=</span><span class="cn">NULL</span>,
                conf_int<span class="op">=</span><span class="cn">FALSE</span>, conf_level<span class="op">=</span><span class="fl">0.95</span>, type<span class="op">=</span><span class="st">"steps"</span>,
                times<span class="op">=</span><span class="cn">NULL</span>, max_t<span class="op">=</span><span class="cn">Inf</span>, use_boot<span class="op">=</span><span class="cn">FALSE</span>,
                size<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">"black"</span>, linetype<span class="op">=</span><span class="st">"solid"</span>,
                alpha<span class="op">=</span><span class="fl">1</span>, conf_int_alpha<span class="op">=</span><span class="fl">0.4</span>,
                points_ci_size<span class="op">=</span><span class="cn">NULL</span>, points_ci_width<span class="op">=</span><span class="cn">NULL</span>,
                xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="cn">NULL</span>, title<span class="op">=</span><span class="cn">NULL</span>,
                subtitle<span class="op">=</span><span class="cn">NULL</span>, gg_theme<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>,
                line_at_0<span class="op">=</span><span class="cn">TRUE</span>, line_at_0_size<span class="op">=</span><span class="fl">0.7</span>,
                line_at_0_color<span class="op">=</span><span class="st">"grey"</span>, line_at_0_linetype<span class="op">=</span><span class="st">"dashed"</span>,
                line_at_0_alpha<span class="op">=</span><span class="fl">1</span>,
                loess_smoother<span class="op">=</span><span class="cn">FALSE</span>, loess_span<span class="op">=</span><span class="fl">0.75</span>,
                loess_color<span class="op">=</span><span class="va">color</span>, loess_size<span class="op">=</span><span class="va">size</span>,
                loess_linetype<span class="op">=</span><span class="st">"dashed"</span>, loess_alpha<span class="op">=</span><span class="va">alpha</span>,
                test<span class="op">=</span><span class="cn">NULL</span>, integral_from<span class="op">=</span><span class="fl">0</span>, integral_to<span class="op">=</span><span class="cn">NULL</span>,
                integral_subdivisions<span class="op">=</span><span class="fl">1000</span>,
                p_value<span class="op">=</span><span class="cn">FALSE</span>, integral<span class="op">=</span><span class="cn">FALSE</span>,
                interval<span class="op">=</span><span class="cn">FALSE</span>, text_pos_x<span class="op">=</span><span class="st">"left"</span>,
                text_pos_y<span class="op">=</span><span class="st">"bottom"</span>, text_size<span class="op">=</span><span class="fl">3.5</span>,
                text_family<span class="op">=</span><span class="st">"serif"</span>, text_fontface<span class="op">=</span><span class="st">"italic"</span>,
                text_color<span class="op">=</span><span class="st">"black"</span>, text_alpha<span class="op">=</span><span class="fl">1</span>,
                text_digits<span class="op">=</span><span class="fl">3</span>, text_format_p<span class="op">=</span><span class="cn">TRUE</span>,
                fill_area<span class="op">=</span><span class="cn">FALSE</span>, area_color<span class="op">=</span><span class="st">"blue"</span>, area_alpha<span class="op">=</span><span class="fl">0.4</span>,
                fill_only_interval<span class="op">=</span><span class="cn">TRUE</span>,
                <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>An <code>adjustedsurv</code> object created using the <code><a href="adjustedsurv.html">adjustedsurv</a></code> function or an <code>adjustedcif</code> object created using the <code><a href="adjustedcif.html">adjustedcif</a></code> function.</p></dd>
<dt>group_1</dt>
<dd><p>A single character string specifying one of the levels of the <code>variable</code> used in the original <code>adjustedsurv</code> or <code>adjustedcif</code> function call. This group will be subtracted from. For example if <code>group_1="A"</code> and <code>group_2="B"</code> the plotted curve will correspond to the survival probability (or CIF) of <code>A</code> minus the survival probability (or CIF) of <code>B</code> over time. If <code>NULL</code>, this will default to the first level of <code>variable</code>.</p></dd>
<dt>group_2</dt>
<dd><p>Also a single character string specifying one of the levels of <code>variable</code>. This corresponds to the right side of the difference equation. See argument <code>group_2</code>. If <code>NULL</code>, this will default to the second level of <code>variable</code>.</p></dd>
<dt>conf_int</dt>
<dd><p>A logical variable indicating whether the confidence intervals should be drawn. This only works when <code>conf_int=TRUE</code> or <code>bootstrap=TRUE</code> was used in the original <code>adjustedsurv</code> or <code>adjustedcif</code> function call.</p></dd>
<dt>conf_level</dt>
<dd><p>The confidence level that should be used when calculating the confidence intervals. Ignored if <code>conf_int=FALSE</code>.</p></dd>
<dt>type</dt>
<dd><p>Must be one of <code>"steps"</code> (drawing the difference as a step function), <code>"lines"</code> (drawing the difference using linear interpolation), <code>"points"</code> (drawing points only) or <code>"none"</code> (drawing nothing, useful when only the smoothed difference is of interest). It defaults to <code>"steps"</code>.</p></dd>
<dt>times</dt>
<dd><p>An optional numeric vector of points in time at which the difference should be estimated. If <code>NULL</code> (default) the differences are estimated for the whole curve. This only affects the plot and has no effect on the <code>integral</code> or <code>p_value</code> if those are also specified.</p></dd>
<dt>max_t</dt>
<dd><p>A number indicating the latest time to which the curve should be extended to.</p></dd>
<dt>use_boot</dt>
<dd><p>Whether to use the bootstrapped estimates to calculate the confidence intervals or not. Can only be used if <code>bootstrap=TRUE</code> was used in the original <code>adjustedsurv</code> or <code>adjustedcif</code> function call. Ignored if <code>conf_int=FALSE</code>.</p></dd>
<dt>size</dt>
<dd><p>A number controlling the thickness of the difference curve.</p></dd>
<dt>color</dt>
<dd><p>A string specifying the color of the difference curve.</p></dd>
<dt>linetype</dt>
<dd><p>A string specifying the linetype of the difference curve.</p></dd>
<dt>alpha</dt>
<dd><p>A number controlling the transparency level of the difference curves.</p></dd>
<dt>conf_int_alpha</dt>
<dd><p>A number indicating the level of transparency that should be used when drawing the confidence regions.</p></dd>
<dt>points_ci_size</dt>
<dd><p>Only used when <code>type="points"</code>. Controls the size of the error bars.</p></dd>
<dt>points_ci_width</dt>
<dd><p>Only used when <code>type="points"</code>. Controls the width of the error bars.</p></dd>
<dt>xlab</dt>
<dd><p>A character string to be used as the X-Axis label of the plot. Defaults to "Time".</p></dd>
<dt>ylab</dt>
<dd><p>A character string to be used as the Y-Axis label of the plot. By default (<code>NULL</code>) uses the equation used to calculate the differences, based on the names supplied in <code>group_1</code> and <code>group_2</code>.</p></dd>
<dt>title</dt>
<dd><p>A character string to be used as the title of the plot. Set to <code>NULL</code> if no title should be used.</p></dd>
<dt>subtitle</dt>
<dd><p>A character string to be used as the subtitle of the plot. Set to <code>NULL</code> if no subtitle should be used.</p></dd>
<dt>gg_theme</dt>
<dd><p>A <code>ggplot2</code> theme object which will be used for the plot.</p></dd>
<dt>line_at_0</dt>
<dd><p>Whether to draw a horizontal line at y = 0 or not.</p></dd>
<dt>line_at_0_size</dt>
<dd><p>The size of the line drawn at y = 0. Ignored if <code>line_at_0=FALSE</code>.</p></dd>
<dt>line_at_0_color</dt>
<dd><p>The color of the line drawn at y = 0. Ignored if <code>line_at_0=FALSE</code>.</p></dd>
<dt>line_at_0_linetype</dt>
<dd><p>The linetype of the line drawn at y = 0. Ignored if <code>line_at_0=FALSE</code>.</p></dd>
<dt>line_at_0_alpha</dt>
<dd><p>The transparency level of the line drawn at y = 0. Ignored if <code>line_at_0=FALSE</code>.</p></dd>
<dt>loess_smoother</dt>
<dd><p>Whether to draw a LOESS smoother through the difference curves.</p></dd>
<dt>loess_span</dt>
<dd><p>The span of the LOESS smoother. Ignored if <code>loess_smoother=FALSE</code>. See <code>stat_smooth</code> in the <code>ggplot2</code> package, <code>method="loess"</code> for more details.</p></dd>
<dt>loess_color</dt>
<dd><p>The color of the LOESS smoother line. Ignored if <code>loess_smoother=FALSE</code>.</p></dd>
<dt>loess_size</dt>
<dd><p>The size of the LOESS smoother line. Ignored if <code>loess_smoother=FALSE</code>.</p></dd>
<dt>loess_linetype</dt>
<dd><p>The linetype of the LOESS smoother line. Ignored if <code>loess_smoother=FALSE</code>.</p></dd>
<dt>loess_alpha</dt>
<dd><p>The transparency level of the LOESS smoother line. Ignored if <code>loess_smoother=FALSE</code>.</p></dd>
<dt>test</dt>
<dd><p>An optional <code>curve_test</code> object created using the <code>adjusted_curve_test</code> function. If supplied it can be used to add a p-value and the integral statistic to the plot. Alternatively, the needed arguments below can be specified to obtain the values needed for the test. See below. Set to <code>NULL</code> (default) to ignore this.</p></dd>
<dt>integral_from</dt>
<dd><p>A number specifying the left limit of the integral. When <code>p_value=TRUE</code> and <code>test=NULL</code>, this argument will be passed to the <code>from</code> argument in the <code>adjusted_curve_test</code> function to perform the test.</p></dd>
<dt>integral_to</dt>
<dd><p>A number specifying the right limit of the integral. When <code>p_value=TRUE</code> and <code>test=NULL</code>, this argument will be passed to the <code>to</code> argument in the <code>adjusted_curve_test</code> function to perform the test.</p></dd>
<dt>integral_subdivisions</dt>
<dd><p>How many subdivisions to use when calculating the integral using the trapezoid rule (<code>integral_interpolation="linear"</code>). When <code>p_value=TRUE</code> and <code>test=NULL</code>, this argument will be passed to the <code>from</code> argument in the <code>adjusted_curve_test</code> function to perform the test.</p></dd>
<dt>p_value</dt>
<dd><p>Whether to add a p-value to the plot or not. This requires either that the user supplies a previously created <code>curve_test</code> object to the <code>test</code> argument, or that the required arguments to call this function are supplied (at least <code>integral_to</code>). Either way it only works if <code>bootstrap=TRUE</code> was used in the original <code>adjustedsurv</code> or <code>adjustedcif</code> function call.</p></dd>
<dt>integral</dt>
<dd><p>Whether to add the integral of the difference in the interval [<code>from</code>, <code>to</code>] to the plot or not. This requires either that the user supplies a previously created <code>curve_test</code> object to the <code>test</code> argument, or that the required arguments to call this function are supplied (at least <code>integral_to</code>).</p></dd>
<dt>interval</dt>
<dd><p>Whether to add the interval in which the integral was calculated to the plot as well.</p></dd>
<dt>text_pos_x</dt>
<dd><p>X position of the text. Can be either <code>"left"</code> (default), <code>"middle"</code>, <code>"right"</code> or a number specifying the exact position.</p></dd>
<dt>text_pos_y</dt>
<dd><p>Y position of the text. Can be either <code>"bottom"</code> (default), <code>"middle"</code>, <code>"top"</code> or a number specifying the exact position.</p></dd>
<dt>text_digits</dt>
<dd><p>The number of digits to which the p-value and the integral of the difference should be rounded to.</p></dd>
<dt>text_size</dt>
<dd><p>The size of the text.</p></dd>
<dt>text_family</dt>
<dd><p>The family of the text. Defaults to <code>"serif"</code>.</p></dd>
<dt>text_fontface</dt>
<dd><p>The fontface of the text. Defaults to <code>"italic"</code>.</p></dd>
<dt>text_color</dt>
<dd><p>The color of the text. Defaults to <code>"black"</code>.</p></dd>
<dt>text_alpha</dt>
<dd><p>The transparency level of the text.</p></dd>
<dt>text_format_p</dt>
<dd><p>Whether to format p-values smaller than 0.01 to &lt; 0.01.</p></dd>
<dt>fill_area</dt>
<dd><p>Whether to add color to the area between 0 and the difference.</p></dd>
<dt>area_color</dt>
<dd><p>The color used to fill in the area between 0 and the difference when using <code>fill_area=TRUE</code>. Ignored otherwise.</p></dd>
<dt>area_alpha</dt>
<dd><p>The transparency level used to fill in the area between 0 and the difference when using <code>fill_area=TRUE</code>. Ignored otherwise.</p></dd>
<dt>fill_only_interval</dt>
<dd><p>Whether only the area corresponding to the interval defined by <code>integral_from</code> and <code>integral_to</code> should be filled. Only used when <code>fill_area=TRUE</code>.</p></dd>
<dt>...</dt>
<dd><p>Currently not used.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function allows the easy creation of difference curves. The syntax is exactly the same for both adjusted survival curves and adjusted CIFs. By default it calculates the difference up to the last point where estimates for both the <code>group_1</code> curve and the <code>group_2</code> curve are available.</p>
<p>It currently does not support plotting multiple difference curves at once, which could be useful when there are more than two treatment groups in <code>variable</code>. If the user is interested in this, we recommend calling this function multiple times with the desired comparisons and concatenating the individual plots into one plot afterwards using a suitable function such as <code>par</code> or <code>ggarrange</code>.</p>
<p>More information on how the differences and their confidence intervals are calculated can be found in the documentation of the <code><a href="adjusted_curve_diff.html">adjusted_curve_diff</a></code> function. More information on how the overall p-value and the integral are calculated can be found in the <code><a href="adjusted_curve_test.html">adjusted_curve_test</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code>ggplot2</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Michael Coory, Karen E. Lamb, and Michael Sorich (2014). "Risk-Difference Curves can be used to Communicate Time-Dependent Effects of Adjuvant Therapies for Early Stage Cancer". In: Journal of Clinical Epidemiology 67, pp. 966-972</p>
<p>Lihui Zhao, Lu Tian, Hajime Uno, Scott D. Solomon, Marc A. Pfeffer, Jerald S. Schindler, and L. J. Wei (2012). "Utilizing the Integrated Difference of Two Survival Functions to Quantify the Treatment Contrast for Designing, Monitoring and Analyzing a Comparative Clinical Study". In: Clinical Trials 9.5, pp. 570-577</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Robin Denz</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="adjusted_curve_diff.html">adjusted_curve_diff</a></code>, <code><a href="adjusted_curve_test.html">adjusted_curve_test</a></code>, <code><a href="adjustedsurv.html">adjustedsurv</a></code>, <code><a href="adjustedcif.html">adjustedcif</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code>, <code><a href="https://adibender.github.io/pammtools/reference/pammtools.html" class="external-link">pammtools</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># simulate some data as example</span></span>
<span class="r-in"><span class="va">sim_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_confounded_surv.html">sim_confounded_surv</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">500</span>, max_t<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sim_dat</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">sim_dat</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># estimate a cox-regression for the outcome</span></span>
<span class="r-in"><span class="va">cox_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">x5</span> <span class="op">+</span> <span class="va">x6</span> <span class="op">+</span> <span class="va">group</span>,</span>
<span class="r-in">                 data<span class="op">=</span><span class="va">sim_dat</span>, x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># use it to calculate adjusted survival curves with bootstrapping</span></span>
<span class="r-in"><span class="va">adjsurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="adjustedsurv.html">adjustedsurv</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sim_dat</span>,</span>
<span class="r-in">                        variable<span class="op">=</span><span class="st">"group"</span>,</span>
<span class="r-in">                        ev_time<span class="op">=</span><span class="st">"time"</span>,</span>
<span class="r-in">                        event<span class="op">=</span><span class="st">"event"</span>,</span>
<span class="r-in">                        method<span class="op">=</span><span class="st">"direct"</span>,</span>
<span class="r-in">                        outcome_model<span class="op">=</span><span class="va">cox_mod</span>,</span>
<span class="r-in">                        conf_int<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">                        bootstrap<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">                        n_boot<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot the difference with default values</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot with reversed differences</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, group_1<span class="op">=</span><span class="st">"1"</span>, group_2<span class="op">=</span><span class="st">"0"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot with confidence intervals</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, conf_int<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot using lines instead</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, conf_int<span class="op">=</span><span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"lines"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot using points instead</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, conf_int<span class="op">=</span><span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"points"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot using an additional loess smoother</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, loess_smoother<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot without the line at 0</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, line_at_0<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot with some custom parameters</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, conf_int<span class="op">=</span><span class="cn">TRUE</span>, color<span class="op">=</span><span class="st">"blue"</span>, linetype<span class="op">=</span><span class="st">"dotted"</span>,</span>
<span class="r-in">                alpha<span class="op">=</span><span class="fl">0.8</span>, line_at_0_size<span class="op">=</span><span class="fl">1.1</span>, line_at_0_color<span class="op">=</span><span class="st">"red"</span>,</span>
<span class="r-in">                loess_smoother<span class="op">=</span><span class="cn">TRUE</span>, loess_span<span class="op">=</span><span class="fl">0.55</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># adding a p-value for a difference test in the interval [0, 0.75]</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, conf_int<span class="op">=</span><span class="cn">TRUE</span>, p_value<span class="op">=</span><span class="cn">TRUE</span>, integral_from<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">                integral_to<span class="op">=</span><span class="fl">0.75</span>, integral<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># adding a p-value for a difference test in the interval [0, 0.75],</span></span>
<span class="r-in"><span class="co"># and also showing that integral visually in the plot</span></span>
<span class="r-in"><span class="fu">plot_difference</span><span class="op">(</span><span class="va">adjsurv</span>, conf_int<span class="op">=</span><span class="cn">FALSE</span>, p_value<span class="op">=</span><span class="cn">TRUE</span>, integral_from<span class="op">=</span><span class="fl">0</span>,</span>
<span class="r-in">                integral_to<span class="op">=</span><span class="fl">0.75</span>, integral<span class="op">=</span><span class="cn">TRUE</span>, fill_area<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">                interval<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Robin Denz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

